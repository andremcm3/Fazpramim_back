{% extends 'base.html' %}
{% block content %}

<div style="max-width:1200px; margin:2rem auto;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2rem;">
        <h1 style="margin:0;">Gerenciar Portf√≥lio</h1>
        <a href="{% url 'my_profile' %}" style="padding:0.5rem 1rem; background:#6c757d; color:white; text-decoration:none; border-radius:6px;">&larr; Voltar ao Perfil</a>
    </div>

    <!-- Formul√°rio para adicionar foto -->
    <div style="background:#fff; padding:2rem; border-radius:12px; border:1px solid #ddd; margin-bottom:2rem;">
        <h2 style="margin:0 0 1.5rem 0;">Adicionar Nova Foto</h2>
        <form method="post" enctype="multipart/form-data" style="display:flex; flex-direction:column; gap:1rem;">
            {% csrf_token %}
            <input type="hidden" name="action" value="add">
            
            <div>
                <label for="photo" style="display:block; margin-bottom:0.5rem; font-weight:600;">Foto: *</label>
                <input type="file" name="photo" id="photo" accept="image/*" required style="width:100%; padding:0.5rem; border:1px solid #ddd; border-radius:6px;">
            </div>

            <div>
                <label for="title" style="display:block; margin-bottom:0.5rem; font-weight:600;">T√≠tulo (opcional):</label>
                <input type="text" name="title" id="title" placeholder="Ex: Instala√ß√£o de ar condicionado" style="width:100%; padding:0.75rem; border:1px solid #ddd; border-radius:6px;">
            </div>

            <div>
                <label for="description" style="display:block; margin-bottom:0.5rem; font-weight:600;">Descri√ß√£o (opcional):</label>
                <textarea name="description" id="description" placeholder="Descreva o trabalho realizado..." style="width:100%; padding:0.75rem; border:1px solid #ddd; border-radius:6px; resize:vertical; min-height:100px;"></textarea>
            </div>

            <button type="submit" style="padding:1rem; background:#28A745; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:600; font-size:1rem;">
                + Adicionar ao Portf√≥lio
            </button>
        </form>
    </div>

    <!-- Grid de fotos do portf√≥lio -->
    <div style="background:#fff; padding:2rem; border-radius:12px; border:1px solid #ddd;">
        <h2 style="margin:0 0 1.5rem 0;">Minhas Fotos ({{ portfolio_photos.count }})</h2>
        
        {% if portfolio_photos %}
        <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(280px, 1fr)); gap:1.5rem;">
            {% for photo in portfolio_photos %}
            <div style="border-radius:8px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.1); background:#f9f9f9;">
                <img src="{{ photo.photo.url }}" alt="{{ photo.title }}" style="width:100%; height:250px; object-fit:cover;">
                <div style="padding:1rem;">
                    {% if photo.title %}
                    <h3 style="margin:0 0 0.5rem 0; font-size:1rem;">{{ photo.title }}</h3>
                    {% endif %}
                    {% if photo.description %}
                    <p style="margin:0 0 0.75rem 0; font-size:0.9rem; color:#666;">{{ photo.description|truncatewords:15 }}</p>
                    {% endif %}
                    <p style="margin:0 0 1rem 0; font-size:0.85rem; color:#999;">{{ photo.created_at|date:"d/m/Y" }}</p>
                    
                    <form method="post" onsubmit="return confirm('Tem certeza que deseja remover esta foto?');" style="margin:0;">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="delete">
                        <input type="hidden" name="photo_id" value="{{ photo.id }}">
                        <button type="submit" style="width:100%; padding:0.75rem; background:#DC3545; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:600;">
                            üóëÔ∏è Remover
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div style="padding:3rem; text-align:center; background:#f9f9f9; border-radius:8px;">
            <p style="margin:0; font-size:1.1rem; color:#666;">Voc√™ ainda n√£o tem fotos no portf√≥lio.</p>
            <p style="margin:0.5rem 0 0 0; color:#999;">Adicione fotos dos seus trabalhos acima!</p>
        </div>
        {% endif %}
    </div>
</div>

{% endblock %}
